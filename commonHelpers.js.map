{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\n\nconst fetchUsersBtn = document.querySelector(\".form\");\nconst gallery = document.querySelector(\".gallery\");\nconst textInput = document.querySelector('.text-input')\nconst modal = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst loader = document.querySelector('.loader');\nloader.style.display = 'none';\n\nconst buttonLoadMore = document.querySelector('.load-more')\nbuttonLoadMore.style.display = 'none';\n\nlet currentPage = 1;\nlet currentSearch = '';\n\n\nfetchUsersBtn.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  const usersValue = textInput.value;\n\n  currentSearch = usersValue;\n\n  gallery.innerHTML = '';\n  textInput.value = '';\n  loader.style.display = 'block';\n  buttonLoadMore.style.display = 'none';\n\n  try {\n    const data = await fetchImages(currentSearch, 1);\n\n    if (data.hits.length === 0) {\n      showAlert('Sorry, there are no images matching your search query. Please try again!');\n      return;\n    }\n\n    const imagesHTML = data.hits.reduce((html, image) => {\n      return html + imageCard(image);\n    }, '');\n\n    gallery.innerHTML = imagesHTML;\n    modal.refresh();\n\n    updateLoadMoreButton(data.totalHits);\n\n  } catch (error) {\n    showAlert(error.toString());\n  }\n});\n\nbuttonLoadMore.addEventListener('click', async () => {\n  loader.style.display = 'block';\n  buttonLoadMore.style.display = 'none';\n\n  try {\n    const data = await fetchImages(currentSearch, currentPage + 1);\n\n    loader.style.display = 'none';\n\n    if (data.hits.length === 0) {\n      showAlert('Sorry, there are no more images for your search query.');\n      return;\n    }\n\n    const additionalImagesHTML = data.hits.reduce((html, image) => {\n      return html + imageCard(image);\n    }, '');\n\n    gallery.innerHTML += additionalImagesHTML;\n    modal.refresh();\n    currentPage++;\n\n    updateLoadMoreButton(data.totalHits);\n    makeSmoothScrolling();\n\n  } catch (error) {\n    showAlert(error.toString());\n  }\n});\n\nasync function fetchImages(query, page) {\n  const searchParams = new URLSearchParams({\n    key: '41485835-9295c11e9848689b047a2c35a',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: 40\n  });\n\n  const response = await axios.get(`https://pixabay.com/api/?${searchParams}`);\n\n  loader.style.display = 'none';\n\n  if (response.status !== 200) {\n    throw new Error(response.status);\n  }\n\n  return response.data;\n}\n\nfunction imageCard(images) {\n  return `<li>\n      <a href=\"${images.largeImageURL}\">\n        <img src=\"${images.webformatURL}\" alt=\"${images.tags}\">\n      </a>\n      <div class=\"info\">\n        <div class=\"image-info\">\n          <span>Likes</span>\n          <span class=\"image-value\">${images.likes}</span>\n        </div>\n        <div class=\"image-info\">\n          <span>Views</span>\n          <span class=\"image-value\">${images.views}</span>\n        </div>\n        <div class=\"image-info\">\n          <span>Comments</span>\n          <span class=\"image-value\">${images.comments}</span>\n        </div>\n        <div class=\"image-info\">\n          <span>Downloads</span>\n          <span class=\"image-value\">${images.downloads}</span>\n        </div>\n      </div>\n    </li>`;\n}\n\nfunction showAlert(message) {\n  iziToast.error({\n    message: message,\n    messageColor: '#FAFAFB',\n    backgroundColor: '#EF4040',\n    position: 'topRight'\n  });\n}\n\nfunction updateLoadMoreButton(totalHits) {\n  if (totalHits > currentPage * 40) {\n    buttonLoadMore.style.display = 'block';\n  } else {\n    buttonLoadMore.style.display = 'none';\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      messageColor: '#FAFAFB',\n      backgroundColor: '#008CBA',\n      position: 'topRight'\n    });\n  }\n}\n\nfunction makeSmoothScrolling() {\n  const galleryItemHeight = document.querySelector('.gallery li').\n    getBoundingClientRect().height;\n  \n  window.scrollBy({\n    top: galleryItemHeight * 2,\n    left: 0,\n    behavior: 'smooth'\n  });\n}"],"names":["fetchUsersBtn","gallery","textInput","modal","SimpleLightbox","loader","buttonLoadMore","currentPage","currentSearch","event","data","fetchImages","showAlert","imagesHTML","html","image","imageCard","updateLoadMoreButton","error","additionalImagesHTML","makeSmoothScrolling","query","page","searchParams","response","axios","images","message","iziToast","totalHits","galleryItemHeight"],"mappings":"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"}
{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nconst searchForm = document.querySelector('.form');\nconst galleryContainer = document.querySelector('.gallery');\nconst loaderElement = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.load-more-btn');\n\nlet searchParamsDefaults = {\n  key: '41777094-15d23fa072ac8c02efe5e3565',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  page: 1,\n  per_page: 40,\n};\n\nlet currentSearchQuery = '';\nlet lightbox;\n\nfunction showLoaderAndHideGallery() {\n  loaderElement.style.display = 'block';\n  galleryContainer.style.display = 'none';\n  loadMoreButton.style.display = 'none';\n}\n\nfunction hideLoaderAndShowGallery(hasMoreImages) {\n  loaderElement.style.display = 'none';\n  galleryContainer.style.display = 'flex';\n  loadMoreButton.style.display = hasMoreImages ? 'block' : 'none';\n}\n\nfunction generateGalleryHTML(hits) {\n  return hits.reduce((html, hit) => {\n    const { largeImageURL, webformatURL, tags, likes, views, comments, downloads } = hit;\n    return (\n      html +\n      `<li class=\"gallery-item\">\n        <a href=${largeImageURL}> \n          <img class=\"gallery-img\" src=${webformatURL} alt=${tags} />\n        </a>\n        <div class=\"gallery-text-box\">\n          <p>Likes: <span class=\"text-value\">${likes}</span></p>\n          <p>views: <span class=\"text-value\">${views}</span></p>\n          <p>comments: <span class=\"text-value\">${comments}</span></p>\n          <p>downloads: <span class=\"text-value\">${downloads}</span></p>\n        </div>\n      </li>`\n    );\n  }, '');\n}\n\nfunction renderGallery(hits) {\n  const galleryHTML = generateGalleryHTML(hits);\n  galleryContainer.innerHTML = galleryHTML;\n}\n\nfunction appendToGallery(hits) {\n  const galleryHTML = generateGalleryHTML(hits);\n  galleryContainer.insertAdjacentHTML('beforeend', galleryHTML);\n  initializeImageLightbox();\n}\n\nfunction initializeImageLightbox() {\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a', {\n      nav: true,\n      captionDelay: 250,\n      captionsData: 'alt',\n      close: true,\n      enableKeyboard: true,\n      docClose: true,\n    });\n  }\n  lightbox.refresh();\n}\n\nfunction handleNoResults() {\n  galleryContainer.style.display = 'none';\n  iziToast.error({\n    position: 'topRight',\n    color: 'red',\n    message: 'Sorry, there are no images matching your search query. Please try again!',\n  });\n}\n\nasync function searchImages(params, append = false) {\n  if (!append) {\n    showLoaderAndHideGallery();\n    // Очистимо галерею та скинемо значення сторінки при новому пошуку\n    galleryContainer.innerHTML = '';\n    searchParamsDefaults.page = 1;\n  }\n\n  try {\n    const response = await axios.get(`https://pixabay.com/api/?${params}`);\n    hideLoaderAndShowGallery(response.data.hits.length >= searchParamsDefaults.per_page);\n\n    if (response.status !== 200) {\n      throw new Error(`Failed to fetch images. Status: ${response.status}`);\n    }\n\n    const { hits } = response.data;\n\n    if (hits.length > 0) {\n      if (append) {\n        appendToGallery(hits);\n      } else {\n        renderGallery(hits);\n      }\n\n      initializeImageLightbox();\n    } else {\n      handleNoResults();\n    }\n\n    // Перевірка чи достатньо зображень для показу кнопки \"Load more\"\n    loadMoreButton.style.display = hits.length >= searchParamsDefaults.per_page ? 'block' : 'none';\n  } catch (error) {\n    console.error(error.message);\n    iziToast.error({\n      position: 'topRight',\n      color: 'red',\n      message: 'Failed to fetch images. Please try again!',\n    });\n  }\n}\n\nsearchForm.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  searchParamsDefaults.q = event.target.elements.search.value.trim();\n  currentSearchQuery = searchParamsDefaults.q;\n\n  // Скидаємо значення сторінки до 1 при новому пошуку\n  searchParamsDefaults.page = 1;\n\n  await searchImages(new URLSearchParams(searchParamsDefaults));\n\n  // Перевірка на нуль перед викликом reset\n  if (event.currentTarget) {\n    event.currentTarget.reset();\n  }\n});\n\nloadMoreButton.addEventListener('click', async () => {\n  searchParamsDefaults.page++;\n  await searchImages(new URLSearchParams(searchParamsDefaults), true);\n});\n\nloadMoreButton.style.display = 'none';"],"names":["searchForm","galleryContainer","loaderElement","loadMoreButton","searchParamsDefaults","lightbox","showLoaderAndHideGallery","hideLoaderAndShowGallery","hasMoreImages","generateGalleryHTML","hits","html","hit","largeImageURL","webformatURL","tags","likes","views","comments","downloads","renderGallery","galleryHTML","appendToGallery","initializeImageLightbox","SimpleLightbox","handleNoResults","iziToast","searchImages","params","append","response","axios","error","event"],"mappings":"owBAMA,MAAMA,EAAa,SAAS,cAAc,OAAO,EAC3CC,EAAmB,SAAS,cAAc,UAAU,EACpDC,EAAgB,SAAS,cAAc,SAAS,EAChDC,EAAiB,SAAS,cAAc,gBAAgB,EAE9D,IAAIC,EAAuB,CACzB,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAM,EACN,SAAU,EACZ,EAGIC,EAEJ,SAASC,GAA2B,CAClCJ,EAAc,MAAM,QAAU,QAC9BD,EAAiB,MAAM,QAAU,OACjCE,EAAe,MAAM,QAAU,MACjC,CAEA,SAASI,EAAyBC,EAAe,CAC/CN,EAAc,MAAM,QAAU,OAC9BD,EAAiB,MAAM,QAAU,OACjCE,EAAe,MAAM,QAAUK,EAAgB,QAAU,MAC3D,CAEA,SAASC,EAAoBC,EAAM,CACjC,OAAOA,EAAK,OAAO,CAACC,EAAMC,IAAQ,CAChC,KAAM,CAAE,cAAAC,EAAe,aAAAC,EAAc,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,EAAGP,EACjF,OACED,EACA;AAAA,kBACYE;AAAA,yCACuBC,SAAoBC;AAAA;AAAA;AAAA,+CAGdC;AAAA,+CACAC;AAAA,kDACGC;AAAA,mDACCC;AAAA;AAAA,YAIhD,EAAE,EAAE,CACP,CAEA,SAASC,EAAcV,EAAM,CAC3B,MAAMW,EAAcZ,EAAoBC,CAAI,EAC5CT,EAAiB,UAAYoB,CAC/B,CAEA,SAASC,EAAgBZ,EAAM,CAC7B,MAAMW,EAAcZ,EAAoBC,CAAI,EAC5CT,EAAiB,mBAAmB,YAAaoB,CAAW,EAC5DE,GACF,CAEA,SAASA,GAA0B,CAC5BlB,IACHA,EAAW,IAAImB,EAAe,aAAc,CAC1C,IAAK,GACL,aAAc,IACd,aAAc,MACd,MAAO,GACP,eAAgB,GAChB,SAAU,EAChB,CAAK,GAEHnB,EAAS,QAAO,CAClB,CAEA,SAASoB,GAAkB,CACzBxB,EAAiB,MAAM,QAAU,OACjCyB,EAAS,MAAM,CACb,SAAU,WACV,MAAO,MACP,QAAS,0EACb,CAAG,CACH,CAEA,eAAeC,EAAaC,EAAQC,EAAS,GAAO,CAC7CA,IACHvB,IAEAL,EAAiB,UAAY,GAC7BG,EAAqB,KAAO,GAG9B,GAAI,CACF,MAAM0B,EAAW,MAAMC,EAAM,IAAI,4BAA4BH,GAAQ,EAGrE,GAFArB,EAAyBuB,EAAS,KAAK,KAAK,QAAU1B,EAAqB,QAAQ,EAE/E0B,EAAS,SAAW,IACtB,MAAM,IAAI,MAAM,mCAAmCA,EAAS,QAAQ,EAGtE,KAAM,CAAE,KAAApB,CAAI,EAAKoB,EAAS,KAEtBpB,EAAK,OAAS,GACZmB,EACFP,EAAgBZ,CAAI,EAEpBU,EAAcV,CAAI,EAGpBa,KAEAE,IAIFtB,EAAe,MAAM,QAAUO,EAAK,QAAUN,EAAqB,SAAW,QAAU,MACzF,OAAQ4B,EAAP,CACA,QAAQ,MAAMA,EAAM,OAAO,EAC3BN,EAAS,MAAM,CACb,SAAU,WACV,MAAO,MACP,QAAS,2CACf,CAAK,CACF,CACH,CAEA1B,EAAW,iBAAiB,SAAU,MAAOiC,GAAU,CACrDA,EAAM,eAAc,EACpB7B,EAAqB,EAAI6B,EAAM,OAAO,SAAS,OAAO,MAAM,OACvC7B,EAAqB,EAG1CA,EAAqB,KAAO,EAE5B,MAAMuB,EAAa,IAAI,gBAAgBvB,CAAoB,CAAC,EAGxD6B,EAAM,eACRA,EAAM,cAAc,OAExB,CAAC,EAED9B,EAAe,iBAAiB,QAAS,SAAY,CACnDC,EAAqB,OACrB,MAAMuB,EAAa,IAAI,gBAAgBvB,CAAoB,EAAG,EAAI,CACpE,CAAC,EAEDD,EAAe,MAAM,QAAU"}